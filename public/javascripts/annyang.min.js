//! annyang
//! version : 0.2.0
//! author  : Tal Ater @TalAter
//! license : MIT
//! https://www.TalAter.com/annyang/
(function(){"use strict";var a,b,c,d=this,e="en-US",f={start:[],error:[],end:[],result:[],resultMatch:[],resultNoMatch:[]},g=!1,h="font-weight: bold; color: #00f;";if(!("webkitSpeechRecognition"in d))return d.annyang=null,null;var i=/\s*\((.*?)\)\s*/g,j=/(\(\?:[^)]+\))\?/g,k=/(\(\?)?:\w+/g,l=/\*\w+/g,m=/[\-{}\[\]+?.,\\\^$|#]/g,n=function(a){return a=a.replace(m,"\\$&").replace(i,"(?:$1)?").replace(k,function(a,b){return b?a:"([^\\s]+)"}).replace(l,"(.*?)").replace(j,"\\s*$1?\\s*"),new RegExp("^"+a+"$","i")},o=function(a){for(var b=0,c=a.length;c>b;b++)a[b].apply(this)};d.annyang={init:function(i){b&&b.abort&&b.abort(),b=new webkitSpeechRecognition,b.maxAlternatives=5,b.continuous=!0,b.lang=e,b.onstart=function(){o(f.start)},b.onerror=function(){o(f.error)},b.onend=function(){o(f.end),c&&d.annyang.start()},b.onresult=function(b){o(f.result);for(var c,e=b.results[b.resultIndex],i=0;i<e.length;i++){c=e[i].transcript.trim(),g&&d.console.log("Speech recognized: %c"+c,h);for(var j=0,k=a.length;k>j;j++){var l=a[j].command.exec(c);if(l){var m=l.slice(1);return g&&(d.console.log("command matched: %c"+a[j].originalPhrase,h),m.length&&d.console.log("with parameters",m)),a[j].callback.apply(this,m),o(f.resultMatch),!0}}}return o(f.resultNoMatch),!1},a=[],this.addCommands(i)},start:function(a){c=arguments.length>0?!!a:!0,b.start()},abort:function(){c=!1,b.abort()},debug:function(a){g=arguments.length>0?!!a:!0},setLanguage:function(a){e=a,b&&b.abort&&(b.lang=a)},addCommands:function(b){var c,e;for(var f in b)if(b.hasOwnProperty(f)){if(c=d[b[f]]||b[f],"function"!=typeof c)continue;e=n(f),a.push({command:e,callback:c,originalPhrase:f})}g&&d.console.log("Commands successfully loaded: %c"+a.length,h)},addCallback:function(a,b){if(void 0!==f[a]){var c=d[b]||b;"function"==typeof c&&f[a].push(c)}}}}).call(this);